/**
 * @file Core2.c
 * @generated by CPrinter
 * @date Tue Sep 17 15:45:04 CEST 2024
 *
 * Code generated for processing element Core2 (ID=2).
 */
#include "preesm_gen.h"

// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int preesmStopThreads;

#ifdef PREESM_MD5_UPDATE
extern struct rk_sema preesmPrintSema;
#endif
extern char *const Brd_Acq_Im_0__snk_out_0_0__0;  // Brd_Acq_Im_0 > snk_out_0_0 size:= 3276800*char defined in Core0
extern double *const out_1_1__in__0;  // Brd_Acq_Im_0_out_1_1 > snk_out_0_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Im_0__snk_out_1_0__0;  // Brd_Acq_Im_0 > snk_out_1_0 size:= 3276800*char defined in Core0
extern double *const out_3_3__in__1;  // Brd_Acq_Im_0_out_3_3 > snk_out_1_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Im_0__snk_out_2_0__0;  // Brd_Acq_Im_0 > snk_out_2_0 size:= 3276800*char defined in Core0
extern double *const out_4_4__in__1;  // Brd_Acq_Im_0_out_4_4 > snk_out_2_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Real_0__snk_out_3_0__0;  // Brd_Acq_Real_0 > snk_out_3_0 size:= 3276800*char defined in Core0
extern double *const out_2_2__in__0;  // Brd_Acq_Real_0_out_2_2 > snk_out_3_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Real_0__snk_out_4_0__0;  // Brd_Acq_Real_0 > snk_out_4_0 size:= 3276800*char defined in Core0
extern double *const out_3_3__in__0;  // Brd_Acq_Real_0_out_3_3 > snk_out_4_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Real_0__snk_out_5_0__0;  // Brd_Acq_Real_0 > snk_out_5_0 size:= 3276800*char defined in Core0
extern double *const out_4_4__in__0;  // Brd_Acq_Real_0_out_4_4 > snk_out_5_0_in size:= 409600*double defined in Core0
extern char *const Brd_Acq_Im_0__snk_out_6_0__0;  // Brd_Acq_Im_0 > snk_out_6_0 size:= 1851392*char defined in Core0
extern double *const out_1_1_3__in__1;  // Brd_Acq_Im_0_out_1_1_3 > snk_out_6_0_in size:= 231424*double defined in Core0
extern char *const Brd_Acq_Real_0__snk_out_7_0__0;  // Brd_Acq_Real_0 > snk_out_7_0 size:= 1851392*char defined in Core0
extern double *const out_1_1_3__in__0; // Brd_Acq_Real_0_out_1_1_3 > snk_out_7_0_in size:= 231424*double defined in Core0
extern char *const Brd_Acq_Im_0__srv_0_1__0;  // Brd_Acq_Im_0 > srv_0_1 size:= 475136*char defined in Core0
extern char *const Brd_Acq_Real_0__srv_0_1__0;  // Brd_Acq_Real_0 > srv_0_1 size:= 475136*char defined in Core0
extern double *const out_0_1_2_3__MAD_Computation_raw_data_real_i__0; // Brd_Acq_Real_0_out_0_1_2_3 > srv_0_1_MAD_Computation_raw_data_real_i size:= 59392*double defined in Core0
extern double *const out_0_1_2_3__MAD_Computation_raw_data_im_i__0; // Brd_Acq_Im_0_out_0_1_2_3 > srv_0_1_MAD_Computation_raw_data_im_i size:= 59392*double defined in Core0
extern double *const MAD_Computation_mad_R_o__in_1__0; // srv_0_1_MAD_Computation_mad_R_o > implode_snk_out_8_0_in_in_1 size:= 59392*double defined in Core0
extern double *const MAD_Computation_mad_I_o__in_1__0; // srv_0_1_MAD_Computation_mad_I_o > implode_snk_out_9_0_in_in_1 size:= 59392*double defined in Core0
extern char *const srv_0_1__implode_snk_out_8_0_in__0; // srv_0_1 > implode_snk_out_8_0_in size:= 475136*char defined in Core0
extern char *const srv_0_0__implode_snk_out_9_0_in__0; // srv_0_0 > implode_snk_out_9_0_in size:= 475136*char defined in Core0
extern char *const srv_0_2__implode_snk_out_9_0_in__0; // srv_0_2 > implode_snk_out_9_0_in size:= 475136*char defined in Core0
extern double *const MAD_Computation_mad_I_o__in_0__0; // srv_0_0_MAD_Computation_mad_I_o > implode_snk_out_9_0_in_in_0 size:= 59392*double defined in Core0
extern double *const MAD_Computation_mad_I_o__in_2__0; // srv_0_2_MAD_Computation_mad_I_o > implode_snk_out_9_0_in_in_2 size:= 59392*double defined in Core0
extern double *const MAD_Computation_mad_I_o__in__0; // implode_snk_out_9_0_in_MAD_Computation_mad_I_o > snk_out_9_0_in size:= 178176*double defined in Core0

// Core Global Definitions

void* computationThread_Core2(void *arg) {
  if (arg != NULL) {
    printf("Warning: expecting NULL arguments\n");
    fflush (stdout);
  }

#ifdef PREESM_MD5_UPDATE
	PREESM_MD5_CTX preesm_md5_ctx_out_1_1__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out_1_1__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_out_3_3__in__1;
	PREESM_MD5_Init(&preesm_md5_ctx_out_3_3__in__1);
	PREESM_MD5_CTX preesm_md5_ctx_out_4_4__in__1;
	PREESM_MD5_Init(&preesm_md5_ctx_out_4_4__in__1);
	PREESM_MD5_CTX preesm_md5_ctx_out_2_2__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out_2_2__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_out_3_3__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out_3_3__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_out_4_4__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out_4_4__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_out_1_1_3__in__1;
	PREESM_MD5_Init(&preesm_md5_ctx_out_1_1_3__in__1);
	PREESM_MD5_CTX preesm_md5_ctx_out_1_1_3__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_out_1_1_3__in__0);
	PREESM_MD5_CTX preesm_md5_ctx_MAD_Computation_mad_I_o__in__0;
	PREESM_MD5_Init(&preesm_md5_ctx_MAD_Computation_mad_I_o__in__0);
#endif
// Initialisation(s)

  // Begin the execution loop
  pthread_barrier_wait(&iter_barrier);

#ifdef PREESM_LOOP_SIZE // Case of a finite loop
	int index;
	for(index=0;index<PREESM_LOOP_SIZE && !preesmStopThreads;index++){
#else // Default case of an infinite loop
  while (!preesmStopThreads) {
#endif
    // loop body
    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    snk_out_0(out_1_1__in__0); // snk_out_0_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_1_1__in__0,(char *)out_1_1__in__0, 3276800);
		#endif

    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    snk_out_1(out_3_3__in__1); // snk_out_1_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_3_3__in__1,(char *)out_3_3__in__1, 3276800);
		#endif

    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    snk_out_2(out_4_4__in__1); // snk_out_2_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_4_4__in__1,(char *)out_4_4__in__1, 3276800);
		#endif

    receiveStart(); // Core0 > Core2
    receiveEnd(0, 2); // Core0 > Core2
    snk_out_3(out_2_2__in__0); // snk_out_3_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_2_2__in__0,(char *)out_2_2__in__0, 3276800);
		#endif

    receiveStart(); // Core0 > Core2
    receiveEnd(0, 2); // Core0 > Core2
    snk_out_4(out_3_3__in__0); // snk_out_4_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_3_3__in__0,(char *)out_3_3__in__0, 3276800);
		#endif

    receiveStart(); // Core0 > Core2
    receiveEnd(0, 2); // Core0 > Core2
    snk_out_5(out_4_4__in__0); // snk_out_5_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_4_4__in__0,(char *)out_4_4__in__0, 3276800);
		#endif

    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    snk_out_6(out_1_1_3__in__1); // snk_out_6_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_1_1_3__in__1,(char *)out_1_1_3__in__1, 1851392);
		#endif

    receiveStart(); // Core0 > Core2
    receiveEnd(0, 2); // Core0 > Core2
    snk_out_7(out_1_1_3__in__0); // snk_out_7_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_out_1_1_3__in__0,(char *)out_1_1_3__in__0, 1851392);
		#endif

    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    receiveStart(); // Core0 > Core2
    receiveEnd(0, 2); // Core0 > Core2
    Cluster_sub0_srv_0(2048/*cfg_0*/, 3/*cfg_1*/, out_0_1_2_3__MAD_Computation_raw_data_real_i__0,
        out_0_1_2_3__MAD_Computation_raw_data_im_i__0, MAD_Computation_mad_R_o__in_1__0,
        MAD_Computation_mad_I_o__in_1__0); // srv_0_1

    sendStart(2, 1); // Core2 > Core1
    sendEnd(); // Core2 > Core1
    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    receiveStart(); // Core1 > Core2
    receiveEnd(1, 2); // Core1 > Core2
    // Join implode_snk_out_9_0_in

    {
      memcpy(MAD_Computation_mad_I_o__in__0 + 0, MAD_Computation_mad_I_o__in_0__0 + 0, 475136); // 59392 * double
      memcpy(MAD_Computation_mad_I_o__in__0 + 59392, MAD_Computation_mad_I_o__in_1__0 + 0, 475136); // 59392 * double
      memcpy(MAD_Computation_mad_I_o__in__0 + 118784, MAD_Computation_mad_I_o__in_2__0 + 0, 475136); // 59392 * double
    }
    snk_out_9(MAD_Computation_mad_I_o__in__0); // snk_out_9_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_MAD_Computation_mad_I_o__in__0,(char *)MAD_Computation_mad_I_o__in__0, 1425408);
		#endif

    // loop footer
    pthread_barrier_wait(&iter_barrier);

  }

#ifdef PREESM_MD5_UPDATE
	// Print MD5
	rk_sema_wait(&preesmPrintSema);
	unsigned char preesm_md5_chars_final[20] = { 0 };
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_1_1__in__0);
	printf("preesm_md5_out_1_1__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_3_3__in__1);
	printf("preesm_md5_out_3_3__in__1 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_4_4__in__1);
	printf("preesm_md5_out_4_4__in__1 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_2_2__in__0);
	printf("preesm_md5_out_2_2__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_3_3__in__0);
	printf("preesm_md5_out_3_3__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_4_4__in__0);
	printf("preesm_md5_out_4_4__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_1_1_3__in__1);
	printf("preesm_md5_out_1_1_3__in__1 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_out_1_1_3__in__0);
	printf("preesm_md5_out_1_1_3__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_MAD_Computation_mad_I_o__in__0);
	printf("preesm_md5_MAD_Computation_mad_I_o__in__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	rk_sema_post(&preesmPrintSema);
#endif

  return NULL;
}

